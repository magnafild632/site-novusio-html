# üõ°Ô∏è Configura√ß√£o Fail2ban - Site Novusio
# Prote√ß√£o contra ataques e tentativas de acesso maliciosas

[DEFAULT]
# Configura√ß√µes gerais
bantime = 3600
findtime = 600
maxretry = 5
backend = systemd
usedns = warn
logencoding = auto
enabled = false
filter = %(__name__)s
destemail = root@localhost
sender = root@localhost
mta = sendmail
protocol = tcp
chain = <known/chain>
port = 0:65535
fail2ban_agent = Fail2Ban/%(fail2ban_version)s

# Configura√ß√µes de banimento
ignoreip = 127.0.0.1/8 ::1
ignorecommand =
bantime.increment = true
bantime.rndtime = 10m
bantime.maxtime = 48h
bantime.factor = 1.0

# Configura√ß√µes de detec√ß√£o
findtime = 10m
maxretry = 5
maxmatches = %(maxretry)s
ignorecommand =
ignoreip = 127.0.0.1/8 ::1
ignoreself = true
ignorehost = 
ignoreuser = 
ignoreregex = 
ignorecache = 
dbfile = /var/lib/fail2ban/fail2ban.sqlite3
dbpurgeage = 86400

# Configura√ß√µes de logging
logtarget = SYSLOG
logencoding = auto
loglevel = INFO
loglevel = DEBUG
syslogsocket = auto
syslogsocket = /dev/log
syslogsocket = /var/run/log
syslogsocket = /var/run/logpriv
socket = /var/run/fail2ban/fail2ban.sock
pidfile = /var/run/fail2ban/fail2ban.pid

# Configura√ß√µes de a√ß√µes
action = %(action_)s
action_mw = %(action_mw)s
action_mwl = %(action_mwl)s
action_xarf = %(action_xarf)s
action_d = %(action_d)s
action_b = %(action_b)s
action_ban = %(action_ban)s
action_unban = %(action_unban)s
action = %(action_)s

[sshd]
enabled = true
port = ssh
filter = sshd
logpath = /var/log/auth.log
maxretry = 3
bantime = 3600
findtime = 600

[nginx-http-auth]
enabled = true
filter = nginx-http-auth
port = http,https
logpath = /var/log/nginx/error.log
maxretry = 6

[nginx-limit-req]
enabled = true
filter = nginx-limit-req
port = http,https
logpath = /var/log/nginx/error.log
maxretry = 10
bantime = 600

[nginx-botsearch]
enabled = true
filter = nginx-botsearch
port = http,https
logpath = /var/log/nginx/access.log
maxretry = 2
bantime = 86400
findtime = 600

[novusio-auth]
enabled = true
filter = novusio-auth
port = http,https
logpath = /var/log/novusio/error.log
maxretry = 5
bantime = 3600
findtime = 600

[novusio-api]
enabled = true
filter = novusio-api
port = http,https
logpath = /var/log/novusio/error.log
maxretry = 10
bantime = 1800
findtime = 300

[novusio-admin]
enabled = true
filter = novusio-admin
port = http,https
logpath = /var/log/novusio/access.log
maxretry = 3
bantime = 7200
findtime = 600

[apache-auth]
enabled = false

[apache-badbots]
enabled = false

[apache-noscript]
enabled = false

[apache-overflows]
enabled = false

[apache-nohome]
enabled = false

[apache-botsearch]
enabled = false

[apache-fakegooglebot]
enabled = false

[apache-modsecurity]
enabled = false

[apache-shellshock]
enabled = false

[php-url-fopen]
enabled = false

[nginx-noscript]
enabled = false

[nginx-badbots]
enabled = false

[nginx-noproxy]
enabled = false

[nginx-nohome]
enabled = false

[nginx-noref]
enabled = false

[nginx-noscript]
enabled = false

[nginx-noproxy]
enabled = false

[nginx-nohome]
enabled = false

[nginx-noref]
enabled = false

[nginx-noscript]
enabled = false

[nginx-noproxy]
enabled = false

[nginx-nohome]
enabled = false

[nginx-noref]
enabled = false

[nginx-noscript]
enabled = false

[nginx-noproxy]
enabled = false

[nginx-nohome]
enabled = false

[nginx-noref]
enabled = false
