# =============================================================================
# CONFIGURAÇÃO FAIL2BAN PARA NOVUSIO
# =============================================================================
# Este arquivo configura o Fail2ban para proteger contra ataques
# Inclui proteção para SSH, Nginx e API
# =============================================================================

[DEFAULT]
# Configurações globais
bantime = 3600
findtime = 600
maxretry = 5
backend = systemd
usedns = warn
logencoding = auto
enabled = false
filter = %(__name__)s
destemail = admin@novusio.com
sender = fail2ban@novusio.com
mta = sendmail
protocol = tcp
chain = <known/chain>
port = 0:65535
fail2ban_agent = Fail2Ban/%(fail2ban_version)s

# Ações padrão
action_ = %(banaction)s[name=%(__name__)s, bantime="%(bantime)s", port="%(port)s", protocol="%(protocol)s", chain="%(chain)s"]
action_mw = %(banaction)s[name=%(__name__)s, bantime="%(bantime)s", port="%(port)s", protocol="%(protocol)s", chain="%(chain)s"]
            %(mta)s-whois[name=%(__name__)s, sender="%(sender)s", dest="%(destemail)s", protocol="%(protocol)s", chain="%(chain)s"]
action_mwl = %(banaction)s[name=%(__name__)s, bantime="%(bantime)s", port="%(port)s", protocol="%(protocol)s", chain="%(chain)s"]
             %(mta)s-whois-lines[name=%(__name__)s, sender="%(sender)s", dest="%(destemail)s", logpath="%(logpath)s", chain="%(chain)s"]
action = %(action_)s

# Jail para SSH
[sshd]
enabled = true
port = ssh
logpath = %(sshd_log)s
backend = %(sshd_backend)s
maxretry = 3
bantime = 3600
findtime = 600

# Jail para Nginx - HTTP Auth
[nginx-http-auth]
enabled = true
filter = nginx-http-auth
port = http,https
logpath = /var/log/nginx/error.log
maxretry = 3
bantime = 3600
findtime = 600

# Jail para Nginx - Limit Req
[nginx-limit-req]
enabled = true
filter = nginx-limit-req
port = http,https
logpath = /var/log/nginx/error.log
maxretry = 10
bantime = 600
findtime = 600

# Jail para Nginx - Bot Search
[nginx-botsearch]
enabled = true
filter = nginx-botsearch
port = http,https
logpath = /var/log/nginx/access.log
maxretry = 2
bantime = 86400
findtime = 600

# Jail para API Abuse
[novusio-api]
enabled = true
filter = novusio-api
port = http,https
logpath = /var/log/nginx/access.log
maxretry = 10
bantime = 3600
findtime = 600

# Jail para Admin Login Abuse
[novusio-admin]
enabled = true
filter = novusio-admin
port = http,https
logpath = /var/log/nginx/access.log
maxretry = 5
bantime = 7200
findtime = 600

# Jail para SQL Injection
[novusio-sql]
enabled = true
filter = novusio-sql
port = http,https
logpath = /var/log/nginx/access.log
maxretry = 3
bantime = 86400
findtime = 600

# Jail para XSS
[novusio-xss]
enabled = true
filter = novusio-xss
port = http,https
logpath = /var/log/nginx/access.log
maxretry = 3
bantime = 86400
findtime = 600

# Jail para Directory Traversal
[novusio-dir]
enabled = true
filter = novusio-dir
port = http,https
logpath = /var/log/nginx/access.log
maxretry = 3
bantime = 86400
findtime = 600
