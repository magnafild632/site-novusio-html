# üõ°Ô∏è Filtros Fail2ban - Site Novusio
# Regras espec√≠ficas para detectar ataques na aplica√ß√£o

[Definition]
# Filtro para tentativas de login falhadas no admin
failregex = ^.*\[error\].*POST.*/api/auth/login.*401.*$
            ^.*\[error\].*POST.*/api/auth/login.*403.*$
            ^.*\[error\].*POST.*/api/auth/login.*400.*$
            ^.*Authentication failed for user.*$
            ^.*Invalid credentials.*$
            ^.*Login attempt failed.*$

ignoreregex =

[Definition]
# Filtro para ataques √† API (rate limiting)
failregex = ^.*\[error\].*POST.*/api/.*429.*$
            ^.*Too many requests.*$
            ^.*Rate limit exceeded.*$
            ^.*API rate limit.*$

ignoreregex =

[Definition]
# Filtro para tentativas de acesso ao painel admin
failregex = ^.*GET.*/admin.*401.*$
            ^.*GET.*/admin.*403.*$
            ^.*Unauthorized access attempt.*$
            ^.*Access denied to admin panel.*$

ignoreregex =

[Definition]
# Filtro para ataques de for√ßa bruta
failregex = ^.*\[error\].*Multiple failed login attempts.*$
            ^.*Brute force attack detected.*$
            ^.*Suspicious login pattern.*$

ignoreregex =

[Definition]
# Filtro para tentativas de SQL injection
failregex = ^.*\[error\].*SQL injection attempt.*$
            ^.*Malicious SQL detected.*$
            ^.*Database attack attempt.*$

ignoreregex =

[Definition]
# Filtro para tentativas de XSS
failregex = ^.*\[error\].*XSS attempt detected.*$
            ^.*Malicious script injection.*$
            ^.*Cross-site scripting attack.*$

ignoreregex =

[Definition]
# Filtro para tentativas de upload maliciosas
failregex = ^.*\[error\].*Malicious file upload.*$
            ^.*Blocked file type.*$
            ^.*Upload attack attempt.*$

ignoreregex =

[Definition]
# Filtro para bots maliciosos
failregex = ^.*Bot.*blocked.*$
            ^.*Malicious bot detected.*$
            ^.*Suspicious bot activity.*$

ignoreregex =

[Definition]
# Filtro para tentativas de acesso a arquivos sens√≠veis
failregex = ^.*GET.*\.env.*$
            ^.*GET.*\.git.*$
            ^.*GET.*\.htaccess.*$
            ^.*GET.*\.htpasswd.*$
            ^.*GET.*package\.json.*$
            ^.*GET.*\.sql.*$

ignoreregex =

[Definition]
# Filtro para ataques de nega√ß√£o de servi√ßo
failregex = ^.*\[error\].*DoS attack detected.*$
            ^.*High request volume attack.*$
            ^.*Resource exhaustion attempt.*$

ignoreregex =
